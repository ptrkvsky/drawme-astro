<script>
  import { splitChars } from "@helpers/splitChars";
  import gsap from "gsap";
  import { SplitText } from "gsap/SplitText";
  gsap.registerPlugin(SplitText);

  document.addEventListener("DOMContentLoaded", function () {
    const splitedWhoAmI = splitChars("#section-who-am-i .who-am-i");

    if (!splitedWhoAmI) return;

    gsap.set(splitedWhoAmI, { yPercent: -110, scale: 0.9 });
    gsap.set(`#svg-cercle-line-1`, {
      drawSVG: false,
    });

    gsap
      .timeline({
        scrollTrigger: {
          trigger: "#section-who-am-i",
          start: "top 85%", // top of the element, bottom of the viewport
        },
      })
      .to(splitedWhoAmI, {
        yPercent: 0,
        delay: 0.5,
        duration: 0.75,
        ease: "expo.out",
        stagger: 0.02,
        scale: 1,
      })
      .to(`#svg-cercle-line-1`, {
        drawSVG: true,
        ease: `expo.inOut`,
        delay: -0.75,
        duration: 1.5,
      });
  });
</script>

<a href="/who-am-i" class="who-am-i" rel="prefetch">
  <span class="text o-hidden split-text">Who am i ?</span>
  <svg
    id="svg-cercle"
    class="circle"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 159 58"
  >
    <path
      id="svg-cercle-line-1"
      fill="none"
      stroke="#71F4DF"
      stroke-width="2px"
      d="M31.53,12.11c-7.76,2.2-17,5.02-23.04,10.63c-3.01,2.8-5.11,6.92-4.43,10.97c1.6,9.55,12.69,13.15,20.86,14.90c14.4,3.09,29.61,3.92,44.30,4.63c12.95,0.63,25.96,0.49,38.85-0.96c11.61-1.31,26.02-2.83,36.19-9.04c6.80-4.15,13.23-12.15,5.47-18.59C129,7.47,99.16,7.34,73.52,8.08C60.22,8.46,38,11.32,26.19,18.02"
    ></path>
  </svg>
</a>

<style lang="scss">
  .who-am-i {
    position: absolute;
    top: 50%;
    left: 50%;
    padding: clamp(37px, 9.2rem, 9.2rem);
    display: flex;
    align-items: center;
    justify-content: center;
    transform: translate(-50%, calc(-50% - 5px));
    letter-spacing: 0.44rem;
    text-align: center;
    color: var(--color-white-beauty);
    text-transform: uppercase;
    font-size: clamp(14px, 2.2rem, 2.2rem);
    font-family: var(--text-body-bold);

    .text {
      display: inline-block;
      line-height: 1;
      position: relative;
      vertical-align: middle;
      color: #fff;
    }

    .circle {
      height: 100%;
      left: 50%;
      transform: translateX(-50%);
      position: absolute;
      top: 0;
      width: 100%;
      max-width: 370px;
    }
  }
</style>
