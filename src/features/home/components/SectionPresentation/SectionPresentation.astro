---
interface AstroProps {
  detail: string;
  presentation: any[];
}
import { toHTML } from '@portabletext/to-html';
import { Image } from '@astrojs/image/components';
import illustrationBook from '@assets/images/illustration_book.png';
import illustrationCrayon from '@assets/images/illustration_crayon.png';
import illustrationFingers from '@assets/images/illustration_fingers.png';
import illustrationLetters from '@assets/images/illustration_letters.png';
import { Encercle } from '@components/Encercle';
import { portableTextComponents } from '@helpers/portableTextComponents';

const { detail, presentation } = Astro.props as AstroProps;
const presentationHTML = toHTML(presentation, {
  components: portableTextComponents,
});
---

<script>
  import gsap from 'gsap';
  import { switchCanva, revealText } from './SectionPresentation.animation';

  switchCanva();
  window.addEventListener('load', () => {
    revealText();
  });
</script>

<section id="section-presentation" class="section-presentation">
  <div class="illustration book opacity-0" data-speed="1.05" data-lag="0.025">
    <Image
      width={372}
      height={404}
      format="avif"
      src={illustrationBook}
      alt="Illustration book"
    />
  </div>
  <div class="illustration crayon opacity-0" data-speed="0.98" data-lag="0.03">
    <Image format="avif" src={illustrationCrayon} alt="Illustration crayon" />
  </div>
  <div class="illustration fingers">
    <div class="relative">
      <div
        class="wrapper-overflow opacity-0"
        data-speed="0.85"
        data-lag="0.025"
      >
        <Image
          format="avif"
          src={illustrationFingers}
          alt="Illustration fingers"
        />
        {/* <div class="reveal" /> */}
      </div>
      <div
        class="illustration letters opacity-0"
        data-speed="1.15"
        data-lag="0.03"
      >
        <Image
          format="avif"
          src={illustrationLetters}
          alt="Illustration letters"
        />
        {/* <div class="reveal" /> */}
      </div>
    </div>
  </div>
  <div
    id="intro-presentation"
    class="intro-presentation opacity-0"
    data-speed="0.95"
    data-lag="0.025"
    set:html={presentationHTML}
  >
  </div>

  <div
    id="intro-detail"
    class="intro-detail opacity-0"
    data-speed="0.98"
    data-lag="0.03"
  >
    {detail}
  </div>
</section>

<style lang="scss">
  .section-presentation {
    position: relative;
    margin: 12.3rem auto;
    padding: 12.3rem 0 0 0;
    height: clamp(400px, 70rem, 70rem);
    max-width: 164rem;
    z-index: 10;
    font-size: 2.4rem;

    /* overflow: hidden; */

    .illustration {
      position: absolute;

      @media screen and (max-width: 550px) {
        display: none;
      } // TODO

      &.fingers {
        top: 6.8rem;
        left: 0;
        img {
          max-width: 33.9rem;
        }
      }

      &.book {
        top: 0;
        left: 55rem;
        img {
          max-width: 18.6rem;
        }
      }

      &.letters {
        bottom: 0;
        right: 0;
        transform: translate(50%, 50%);
        img {
          max-width: 20.4rem;
        }
      }

      &.crayon {
        bottom: 0;
        left: 55rem;
        img {
          max-width: 25.8rem;
        }
      }
    }

    .intro-presentation {
      margin-left: 69rem;
      margin-top: 12rem;
      font-size: 3rem;
      max-width: 57.1rem;
      line-height: 1.2;
      letter-spacing: 0.2rem;
      font-family: var(--text-body-bold);
    }

    .intro-detail {
      position: absolute;
      right: 0;
      margin-top: 7.2rem;
      max-width: 67.6rem;
      line-height: 1.4;
      letter-spacing: clamp(2px, 0.2rem, 0.2rem);
      font-weight: 800;
      font-size: clamp(21px, 2.1rem, 2.1rem);
      font-family: MontrealThin;
    }

    .wrapper-svg {
      position: absolute;
      right: 0;
      bottom: 0;
      margin-top: 8rem;
      width: 67.6rem;
    }
  }
</style>
